/*
Tabes
*/
CREATE TABLE EMPLOYEE
(
EMPLOYEEID NUMBER PRIMARY KEY,
FIRSTNAME VARCHAR2(80),
LASTNAME VARCHAR2(80),
STREET_ADDRESS VARCHAR2(200),
CITY VARCHAR2(80),
STATE_NAME VARCHAR2(80),
ZIPCODE NUMBER,
USERNAME VARCHAR2(80),
SUPERVISORID NUMBER,
EMPLOYEE_TYPE VARCHAR2(100)
);

CREATE TABLE LOGIN
(
USERNAME VARCHAR2(80) PRIMARY KEY,
PASSWORD VARCHAR2(80)
);

CREATE TABLE REQUESTS
(
REQUESTID NUMBER PRIMARY KEY,
EMPLOYEEID NUMBER,
AMOUNT NUMBER(10,2),
STATUS VARCHAR2(80),
EVENTID NUMBER,
JUSTIFICATION VARCHAR2(500)
);

CREATE TABLE EVENTS
(
EVENTID NUMBER PRIMARY KEY,
EVENT_TYPE VARCHAR2(100),
GRADING_FORMAT_ID NUMBER,
EVENT_DATE DATE,
EVENT_TIME DATE,
EVENT_LOCATION VARCHAR2(100),
EVENT_DESCRIPTION VARCHAR2(500),
EVENT_STATUS VARCHAR2(20)
);

CREATE TABLE GRADING_FORMAT
(
GRADING_FORMAT_ID NUMBER PRIMARY KEY,
GRADING_SCALE VARCHAR2(200),
PASSCONDITION VARCHAR2(100)
);

/*
Constraints
*/
ALTER TABLE EMPLOYEE ADD CONSTRAINT FK_EMPLOYEE
FOREIGN KEY (USERNAME) REFERENCES LOGIN (USERNAME);

ALTER TABLE REQUESTS ADD CONSTRAINT FK_REQUESTS
FOREIGN KEY (EMPLOYEEID) REFERENCES EMPLOYEE (EMPLOYEEID);

ALTER TABLE REQUESTS ADD CONSTRAINT FK_REQUESTS_EVENT
FOREIGN KEY (EVENTID) REFERENCES EVENTS (EVENTID);

ALTER TABLE EVENTS ADD CONSTRAINT FK_EVENTS
FOREIGN KEY (GRADING_FORMAT_ID) REFERENCES GRADING_FORMAT (GRADING_FORMAT_ID);

/*
Sequences
*/
CREATE SEQUENCE EMPLOYEEID_SEQ;
CREATE SEQUENCE REQUESTID_SEQ;
CREATE SEQUENCE EVENTID_SEQ;
CREATE SEQUENCE GRADING_FORMAT_SEQ;

/*
Stored Procedures
*/
CREATE OR REPLACE PROCEDURE CREATE_EMPLOYEE_PROCEDURE
(F_NAME IN VARCHAR2, L_NAME IN VARCHAR2, S_ADDRESS IN VARCHAR2, E_CITY IN VARCHAR2, E_STATE IN VARCHAR, E_ZIP IN NUMBER,
E_USERNAME IN VARCHAR2, E_PASSWORD IN VARCHAR2, SUPERVISORID IN NUMBER, E_TYPE IN VARCHAR2)
AS 
BEGIN
INSERT INTO LOGIN VALUES(E_USERNAME,E_PASSWORD);
INSERT INTO EMPLOYEE VALUES(EMPLOYEEID_SEQ.NEXTVAL,F_NAME,L_NAME,S_ADDRESS,E_CITY,E_STATE,E_ZIP,E_USERNAME,SUPERVISORID,E_TYPE);
COMMIT;
END;
/

/*
Seeds
*/
EXECUTE CREATE_EMPLOYEE_PROCEDURE('Nick','Helgeland','3359 state route 36','Jasper','NY',14855,'TheDude','password','0','employee');
EXECUTE CREATE_EMPLOYEE_PROCEDURE('Garret','Polinski','Reflections','Tampa','FL',33601,'GPolinsky','password','0','employee');


